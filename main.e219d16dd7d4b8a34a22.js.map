{"version":3,"sources":["webpack:///./index.js"],"names":["refs","form","document","querySelector","nameInput","commentInput","commentsList","loginBtn","formBtn","addToLocal","comment","commentsArr","getCommentsFromLocal","push","localStorage","setItem","JSON","stringify","parse","getItem","renderComments","commentArr","value","markup","map","el","id","name","date","join","innerHTML","addEventListener","debounce","e","preventDefault","fetch","method","body","headers","then","resp","json","data","sendComments","Date","now","toLocaleDateString","toLocaleTimeString","error","text","delay","leading","trailing","window","target","localName","filteredComments","filter","parentNode"],"mappings":"0PAQMA,EAAO,CACXC,KAAMC,SAASC,cAAc,iBAC7BC,UAAWF,SAASC,cAAc,SAClCE,aAAcH,SAASC,cAAc,YACrCG,aAAcJ,SAASC,cAAc,aACrCI,SAAUL,SAASC,cAAc,aACjCK,QAASN,SAASC,cAAc,iBA0DlC,SAASM,EAAWC,GAClB,IAAMC,EAAcC,IACpBD,EAAYE,KAAKH,GACjBI,aAAaC,QAAQ,WAAYC,KAAKC,UAAUN,IAGlD,SAASC,IACP,OAAOI,KAAKE,MAAMJ,aAAaK,QAAQ,aAAe,MAGxD,SAASC,IACP,IAAMC,EAAaT,IACnBZ,EAAKI,UAAUkB,MAAQ,GACvBtB,EAAKK,aAAaiB,MAAQ,GAC1B,IAAMC,EAASF,EACZG,KAAI,SAAAC,GACH,iBAAkBA,EAAGC,GAArB,mBACMD,EAAGE,KADT,mBAEKF,EAAGG,KAFR,kBAGKH,EAAGf,QAHR,oDAODmB,KAAK,IACR7B,EAAKM,aAAawB,UAAYP,EA9BhCvB,EAAKC,KAAK8B,iBACR,SACAC,KA/BF,SAAqBC,GACnBA,EAAEC,iBAE2B,KAAzBlC,EAAKI,UAAUkB,OAQa,KAA5BtB,EAAKK,aAAaiB,MA/BxB,SAAsBZ,GACbyB,MACL,0FACA,CACEC,OAAQ,OACRC,KAAMrB,KAAKC,UAAUP,GACrB4B,QAAS,CACP,eAAgB,sBAInBC,MAAK,SAAAC,GAAI,OAAIA,EAAKC,UAClBF,MAAK,SAAAG,GAEJ,OADAhC,EAAQgB,GAAKgB,EAAKf,KACXjB,KAER6B,KAAK9B,GACL8B,KAAKnB,GA6BRuB,CAPgB,CACdf,KAAS,IAAIgB,KAAKA,KAAKC,OAAOC,qBAA1B,IAAkD,IAAIF,KACxDA,KAAKC,OACLE,qBACFpB,KAAM3B,EAAKI,UAAUkB,MACrBZ,QAASV,EAAKK,aAAaiB,QApB3B0B,gBAAM,CACJC,KAAM,iBACNC,MAAO,QAyBW,IAAK,CAAEC,SAAS,EAAMC,UAAU,KACtD,GA8BFC,OAAOtB,iBAAiB,OAAQX,GAEhCpB,EAAKM,aAAayB,iBAAiB,SAEnC,SAAuBE,GACrB,GAA2B,WAAvBA,EAAEqB,OAAOC,UACX,OAEF,IAAMC,EAAmB5C,IAAuB6C,QAAO,SAAAhC,GACrD,OAAOA,EAAGC,KAAOO,EAAEqB,OAAOI,WAAWhC,MAEvCZ,aAAaC,QAAQ,WAAYC,KAAKC,UAAUuC,IAChDpC,S","file":"main.e219d16dd7d4b8a34a22.js","sourcesContent":["//AIzaSyCniRY8mOu8mbV8PRMWbZHKAGJrPGGPrL8\r\n\r\nimport './styles.css';\r\nimport { error } from '@pnotify/core';\r\nimport '@pnotify/core/dist/PNotify.css';\r\nimport '@pnotify/core/dist/BrightTheme.css';\r\nimport debounce from 'lodash.debounce';\r\n\r\nconst refs = {\r\n  form: document.querySelector('.comment-form'),\r\n  nameInput: document.querySelector('.name'),\r\n  commentInput: document.querySelector('.comment'),\r\n  commentsList: document.querySelector('.comments'),\r\n  loginBtn: document.querySelector('.log-btn '),\r\n  formBtn: document.querySelector('.submit-form'),\r\n};\r\n\r\nfunction sendComments(comment) {\r\n  return fetch(\r\n    'https://firstproject-b95dd-default-rtdb.europe-west1.firebasedatabase.app/comments.json',\r\n    {\r\n      method: 'POST',\r\n      body: JSON.stringify(comment),\r\n      headers: {\r\n        'content-type': 'application/json',\r\n      },\r\n    },\r\n  )\r\n    .then(resp => resp.json())\r\n    .then(data => {\r\n      comment.id = data.name;\r\n      return comment;\r\n    })\r\n    .then(addToLocal)\r\n    .then(renderComments);\r\n}\r\n\r\nfunction sendRequest(e) {\r\n  e.preventDefault();\r\n\r\n  if (refs.nameInput.value === '') {\r\n    error({\r\n      text: 'input is empty',\r\n      delay: 1000,\r\n    });\r\n    return;\r\n  }\r\n\r\n  if (refs.commentInput.value === '') {\r\n    error({\r\n      text: 'input is empty',\r\n      delay: 1000,\r\n    });\r\n    return;\r\n  }\r\n\r\n  const comment = {\r\n    date: `${new Date(Date.now()).toLocaleDateString()} ${new Date(\r\n      Date.now(),\r\n    ).toLocaleTimeString()}`,\r\n    name: refs.nameInput.value,\r\n    comment: refs.commentInput.value,\r\n  };\r\n  sendComments(comment);\r\n}\r\n\r\nrefs.form.addEventListener(\r\n  'submit',\r\n  debounce(sendRequest, 500, { leading: true, trailing: false }),\r\n  false,\r\n);\r\n\r\nfunction addToLocal(comment) {\r\n  const commentsArr = getCommentsFromLocal();\r\n  commentsArr.push(comment);\r\n  localStorage.setItem('comments', JSON.stringify(commentsArr));\r\n}\r\n\r\nfunction getCommentsFromLocal() {\r\n  return JSON.parse(localStorage.getItem('comments') || '[]');\r\n}\r\n\r\nfunction renderComments() {\r\n  const commentArr = getCommentsFromLocal();\r\n  refs.nameInput.value = '';\r\n  refs.commentInput.value = '';\r\n  const markup = commentArr\r\n    .map(el => {\r\n      return `<li id=\"${el.id}\">  \r\n      <h3>${el.name}</h3>\r\n      <p>${el.date}</p>\r\n      <p>${el.comment}</p>\r\n      <button>delete</button>\r\n    </li>`;\r\n    })\r\n    .join('');\r\n  refs.commentsList.innerHTML = markup;\r\n}\r\n\r\nwindow.addEventListener('load', renderComments);\r\n\r\nrefs.commentsList.addEventListener('click', deleteComment);\r\n\r\nfunction deleteComment(e) {\r\n  if (e.target.localName !== 'button') {\r\n    return;\r\n  }\r\n  const filteredComments = getCommentsFromLocal().filter(el => {\r\n    return el.id !== e.target.parentNode.id;\r\n  });\r\n  localStorage.setItem('comments', JSON.stringify(filteredComments));\r\n  renderComments();\r\n}\r\n"],"sourceRoot":""}